{% extends 'videos/base.html' %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<h1 class="mb-4">Dashboard</h1>
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-bg-primary mb-3">
            <div class="card-body">
                <h5 class="card-title">Total Videos</h5>
                <p class="card-text display-6">{{ total_videos }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-bg-secondary mb-3">
            <div class="card-body">
                <h5 class="card-title">Audio Tracks</h5>
                <p class="card-text display-6">{{ total_audio }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-bg-success mb-3">
            <div class="card-body">
                <h5 class="card-title">Projects</h5>
                <p class="card-text display-6">{{ total_projects }}</p>
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <h4>Status Breakdown</h4>
        <ul class="list-group">
            {% for item in status_counts %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    {{ item.status|capfirst }}
                    {% if item.status == 'failed' %}
                        <span class="badge bg-danger rounded-pill">{{ item.total }}</span>
                    {% elif item.status == 'processing' %}
                        <span class="badge bg-warning text-dark rounded-pill">{{ item.total }}</span>
                    {% elif item.status == 'ready' %}
                        <span class="badge bg-success rounded-pill">{{ item.total }}</span>
                    {% else %}
                        <span class="badge bg-secondary rounded-pill">{{ item.total }}</span>
                    {% endif %}
                </li>
            {% empty %}
                <li class="list-group-item">No data yet.</li>
            {% endfor %}
        </ul>
    </div>
    <div class="col-md-6">
        <h4>Mood Breakdown</h4>
        <ul class="list-group">
            {% for item in mood_counts %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    {{ item.mood|default:'Unspecified'|capfirst }}
                    <span class="badge bg-secondary rounded-pill">{{ item.total }}</span>
                </li>
            {% empty %}
                <li class="list-group-item">No data yet.</li>
            {% endfor %}
        </ul>
    </div>
</div>

<div class="card">
    <div class="card-header">Recent Videos</div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped mb-0">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Status</th>
                        <th>Created</th>
                    </tr>
                </thead>
                <tbody>
                    {% for video in recent_videos %}
                        <tr>
                            <td><a href="{% url 'video-detail' video.pk %}">{{ video.title }}</a></td>
                            <td>
                                {% if video.status == 'failed' %}
                                    <span class="badge bg-danger">{{ video.status|capfirst }}</span>
                                {% elif video.status == 'processing' %}
                                    <span class="badge bg-warning text-dark">{{ video.status|capfirst }}</span>
                                {% elif video.status == 'ready' %}
                                    <span class="badge bg-success">{{ video.status|capfirst }}</span>
                                {% else %}
                                    <span class="badge bg-secondary">{{ video.status|capfirst }}</span>
                                {% endif %}
                            </td>
                            <td>{{ video.created_at }}</td>
                        </tr>
                    {% empty %}
                        <tr><td colspan="3">No videos yet.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
